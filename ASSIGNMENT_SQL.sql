CREATE DATABASE assignment;

USE assignment;

-- creating and inserting the values to table salespeople

CREATE TABLE SALESPEOPLE(
SNUM INT PRIMARY KEY,
SNAME VARCHAR(40) UNIQUE,
CITY VARCHAR(20),
COMM INT);

DESCRIBE SALESPEOPLE;


INSERT INTO SALESPEOPLE(SNUM,SNAME,CITY,COMM) VALUES (1001,'Peel','London',12);
INSERT INTO SALESPEOPLE(SNUM,SNAME,CITY,COMM) VALUES (1002, 'Serres' ,'Sanjose',13);
INSERT INTO SALESPEOPLE(SNUM,SNAME,CITY,COMM) VALUES (1004,'Motika','London',11);
INSERT INTO SALESPEOPLE(SNUM,SNAME,CITY,COMM) VALUES (1007,'Rifkin','Barcelona',15);
INSERT INTO SALESPEOPLE(SNUM,SNAME,CITY,COMM) VALUES (1003, 'Axelrod', 'Newyork', 10);

SELECT * FROM SALESPEOPLE;

-- create a table customer and inserting values into it

CREATE TABLE CUSTOMERS(
CNUM INT PRIMARY KEY,
CNAME VARCHAR(30),
CITY VARCHAR(20) NOT NULL,
SNUM INT,
FOREIGN KEY(SNUM) REFERENCES SALESPEOPLE(SNUM));

DESCRIBE CUSTOMERS;

INSERT INTO CUSTOMERS(CNUM,CNAME,CITY,SNUM) VALUES (2001,'Hoffman','London',1001);
INSERT INTO CUSTOMERS(CNUM,CNAME,CITY,SNUM) VALUES (2002, 'Giovanni','Rome',1003);
INSERT INTO CUSTOMERS(CNUM,CNAME,CITY,SNUM) VALUES (2003, 'Liu', 'Sanjose', 1002);
INSERT INTO CUSTOMERS(CNUM,CNAME,CITY,SNUM) VALUES (2004, ' Grass', 'Berlin', 1002);
INSERT INTO CUSTOMERS(CNUM,CNAME,CITY,SNUM) VALUES (2006, 'Clemens', 'London', 1001);
INSERT INTO CUSTOMERS(CNUM,CNAME,CITY,SNUM) VALUES (2008, 'Cisneros','Sanjose',1007);
INSERT INTO CUSTOMERS(CNUM,CNAME,CITY,SNUM) VALUES (2007, 'Pereira', 'Rome', 1004);

SELECT * FROM CUSTOMERS;


-- CREATE A TABLE ORDERS AND INSERT VALUES INTO IT

CREATE TABLE ORDERS(
ONUM INT PRIMARY KEY,
AMT FLOAT,
ODATE DATE,
CNUM INT,
FOREIGN KEY(CNUM) REFERENCES CUSTOMERS(CNUM),
SNUM INT,
FOREIGN KEY(SNUM) REFERENCES SALESPEOPLE(SNUM));


DESCRIBE ORDERS;

INSERT INTO ORDERS(ONUM,AMT,ODATE,CNUM,SNUM) VALUES (3001, 18.69, '1990-10-03', 2008, 1007),
(3003,767.19,'1990-10-03',2001,1001),
(3002,1900.10,'1990-10-03',2007,1004),
(3005,5160.45,'1990-10-03',2003,1002),
(3006,1098.16,'1990-10-03',2008,1007),
(3009,1713.23,'1990-10-04',2002,1003),
(3007,75.75,'1990-10-04',2004,1002),
(3008,4273.00,'1990-10-05',2006,1001),
(3010,1309.95,'1990-10-06',2004,1002),
(3011,9891.88,'1990-10-06',2006,1001);

SELECT * FROM ORDERS;


#1. Count the number of Salesperson whose name begin with ‘a’/’A’.

SELECT COUNT(*) AS NO_OF_PERSONS_A FROM SALESPEOPLE WHERE SNAME LIKE 'a%' OR SNAME LIKE 'A%';


# Display all the Salesperson whose all orders worth is more than Rs. 2000

SELECT DISTINCT(SALESPEOPLE.SNUM)
FROM SALESPEOPLE
JOIN ORDERS
ON SALESPEOPLE.SNUM=ORDERS.SNUM
WHERE ORDERS.AMT>2000;

# 3.Count the number of Salesperson belonging to Newyork.

SELECT COUNT(*)
FROM SALESPEOPLE 
WHERE CITY ='Newyork';

# 4. Display the number of Salespeople belonging to London and belonging to Paris.

SELECT COUNT(*)
FROM SALESPEOPLE
WHERE CITY='London' OR CITY='Paris';

# 5.Display the number of orders taken by each Salesperson and their date of orders

SELECT SNUM,COUNT(*),ODATE FROM ORDERS GROUP BY SNUM,ODATE;





